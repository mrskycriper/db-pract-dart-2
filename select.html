<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Лабораторная №1 на Dart</title>
	<link href="style.css" rel="stylesheet">
	</link>
</head>

<body>
	<h1><a href=".">Лабораторная №1 на Dart</a></h1>
	<form id="insert-form">
		<div>
			<label for="last_name">Фамилия</label>
			<input type="text" id="last_name" name="last_name" placeholder="Фамилия" required />
		</div>

		<div>
			<label for="first_name">Имя</label>
			<input type="text" id="first_name" name="first_name" placeholder="Имя" required />
		</div>

		<div>
			<label for="middle_name">Отчество</label>
			<input type="text" id="middle_name" name="middle_name" placeholder="Отчество" />
		</div>

		<div>
			<label for="passport">Паспорт</label>
			<input type="text" id="passport" name="passport" placeholder="Паспорт" required />
		</div>

		<div>
			<label for="tax_id">ИНН</label>
			<input type="text" id="tax_id" name="tax_id" placeholder="ИНН" />
		</div>

		<div>
			<label for="isurance_id">СНИЛС</label>
			<input type="text" id="isurance_id" name="isurance_id" placeholder="СНИЛС" />
		</div>

		<div>
			<label for="drivers_license">Водительские права</label>
			<input type="text" id="drivers_license" name="drivers_license" placeholder="Водительские права" />
		</div>
		<div>
			<label for="additional_documents">Дополнительные документы</label>
			<input type="text" id="additional_documents" name="additional_documents"
				placeholder="Дополнительные документы" />
		</div>
		<div>
			<label for="notes">Примечание</label>
			<input type="text" id="notes" name="notes" placeholder="Примечание" />
		</div>
		<input type="submit" value="Добавить" />
	</form>
	<br />
	<table>
		@tr
	</table>
	<p>
		Версия базы данных:
		<b>
			@ver
		</b>
	</p>
</body>

<script>
	document.getElementById('insert-form').addEventListener('submit', function (event) {
		event.preventDefault();
		const form = event.target;
		const formData = new FormData(form);
		const params = new URLSearchParams(formData).toString();
		const keys = formData.keys();
		for (let key of keys) {
			formData.set(key, formData.get(key).trim());
		}
		fetch(`${form.action}?${params}`, {
			method: 'GET'
		}).then(response => {
			if (response.ok) {
				window.history.replaceState({}, document.title, window.location.pathname);
				setTimeout(() => {
					location.reload();
				}, 1000);
			} else {
				console.error(response.error);
			}
		});
	});
</script>

</html>